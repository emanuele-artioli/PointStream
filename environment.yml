# Unified PointStream Environment
# Combines dependencies for both project use and training autodistill models
# After activation, run the following commands:
# conda activate pointstream && mim install mmcv==2.1.0 mmdet==3.2.0 mmpose==1.3.2 mmpretrain

name: pointstream
channels:
  - nvidia/label/cuda-12.4.0
  - pytorch
  - nvidia
  - conda-forge
  - defaults
dependencies:
  # Core
  - python=3.10
  - pip

  # Pytorch and CUDA (Using 12.4 for better compatibility)
  - pytorch>=2.6.0
  - torchvision>=0.21.0
  - torchaudio>=2.6.0
  - pytorch-cuda=12.4
  - cuda
  - cudatoolkit

  # Computer Vision & Image Processing
  - opencv 
  - scikit-image
  - matplotlib
  - pillow
  - ffmpeg

  # Machine Learning Libraries
  - ultralytics
  - numpy<2
  - scikit-learn
  - openmim
  - transformers>=4.45.0  # Updated to resolve PyTree deprecation warnings
  - setuptools>=60.2.0,<70  # Compatible version to reduce pkg_resources warnings

  # Development & Analysis
  - tqdm
  - jupyter
  - pytest

  # Pip dependencies
  - pip:
    # Core project dependencies
    - scenedetect[opencv]
    - google-genai
    - natsort
    
    # Training dependencies (autodistill with required components)
    - autodistill
    - autodistill-grounded-sam
    - roboflow # Installed with no dependencies to avoid conflicts
    - pi-heif
    - pillow-avif-plugin
    
    # Additional training and development tools
    - requests-toolbelt
    - python-dotenv
    - filetype
    - wandb  # For experiment tracking
    - tensorboard  # For monitoring training
    - ipykernel  # Jupyter kernel support