# Video Scene Splitter Configuration File
# This file contains all configurable parameters for the video scene splitting scripts
# Modify these values to customize the behavior of the scene detection and encoding

[general]
# Default output directory pattern (use {input_stem} for input filename without extension)
default_output_pattern = {input_stem}_scenes

# Default batch size for batch processing (frames per batch)
default_batch_size = 100

# Default maximum frames per scene before forced split
default_max_frames = 1000

# Default scene detection threshold (lower = more sensitive, more scenes)
default_threshold = 30.0

# Whether to create scene list files by default
create_scene_list = true

# Whether to merge adjacent/overlapping scenes
merge_adjacent_scenes = true

# Tolerance for merging adjacent scenes (seconds)
merge_tolerance = 0.1

[scene_detection]
# Scene detection algorithm parameters
threshold = 27.0
min_scene_len = 5
fade_bias = 0.0

# Content detector specific settings
luma_only = false
kernel_size = 3

[video_processing]
# Video input parameters
skip_frames = 0
max_duration = 0

# Frame extraction settings
frame_skip = 1
downscale_factor = 1.0

[encoding]
# Video encoding parameters
video_codec = libsvtav1
audio_codec = libopus

# Video quality settings
crf = 30
preset = 6
pixel_format = yuv420p
color_range = tv
color_space = bt709

# Audio settings
audio_bitrate = 128k
audio_sample_rate = 48000
audio_channels = 2

# Advanced encoding options
two_pass = false
tune = 
profile = 

# Container settings
container_format = mp4
faststart = true

[ffmpeg]
# FFmpeg-specific settings
ffmpeg_binary = ffmpeg
ffmpeg_timeout = 300
ffmpeg_threads = 0

# Error handling
continue_on_error = false
retry_failed = 1

# Additional FFmpeg arguments (advanced)
extra_input_args = []
extra_output_args = []

[output]
# Output file naming
scene_filename_pattern = scene_{number:04d}.{extension}
scene_list_filename = scene_list.txt
metadata_filename = metadata.json

# File organization
organize_by_duration = false
organize_by_size = false
duration_thresholds = [5, 15, 60]
size_thresholds = [1, 10, 50]

# Metadata export
export_metadata = true
include_timestamps = true
include_file_info = true
include_encoding_info = true

[batch_processing]
# Batch processing specific settings
batch_size = 100            # Frames per batch
overlap_frames = 10         # Overlap between batches to catch scene transitions
memory_limit_mb = 1024      # Memory limit for batch processing (MB)
parallel_batches = 1        # Number of batches to process in parallel

# Batch optimization
adaptive_batch_size = true  # Automatically adjust batch size based on video
min_batch_size = 50         # Minimum batch size when adaptive
max_batch_size = 500        # Maximum batch size when adaptive

[quality_control]
# Quality control and validation
min_scene_duration = 0.5    # Minimum scene duration in seconds
max_scene_duration = 300    # Maximum scene duration in seconds (0 = no limit)
min_file_size_kb = 10       # Minimum output file size in KB
max_file_size_mb = 1000     # Maximum output file size in MB (0 = no limit)

# Validation checks
verify_output_files = true  # Verify output files after creation
check_video_integrity = true    # Check video integrity with ffprobe
remove_invalid_files = false    # Remove files that fail validation

[logging]
# Logging and progress reporting
log_level = INFO
log_to_file = true
log_filename_pattern = {input_stem}_processing.log
progress_bar = true
verbose_ffmpeg = false

# Statistics
collect_statistics = true
statistics_filename = processing_stats.json

[performance]
# Performance optimization
use_gpu_acceleration = false    # Use GPU acceleration if available
gpu_device = 0                  # GPU device index
memory_optimization = true     # Enable memory optimizations
disk_cache_size_mb = 512       # Disk cache size for temporary files

# Threading
max_workers = 4             # Maximum number of worker threads
io_threads = 2              # Number of I/O threads
encoding_threads = 0        # Number of encoding threads per job (0 = auto)

[advanced]
# Advanced processing options
custom_scene_detectors = []     # Custom scene detector configurations
post_processing_filters = []    # Post-processing video filters
scene_transition_effects = []   # Transition effects between scenes

# Experimental features
experimental_features = false  # Enable experimental features
debug_mode = false             # Enable debug mode
dry_run = false                # Perform dry run without actual encoding

# Integration settings
webhook_url = ""               # Webhook URL for completion notifications
email_notifications = false   # Send email notifications
notification_events = ["completion", "error"]  # Events to notify about

[segmentation]
# YOLO model configuration
yolo_model = yolov8n-seg.pt
confidence_threshold = 0.25    # Minimum confidence for object detection (YOLO's built-in filter)
iou_threshold = 0.7            # IoU threshold for non-maximum suppression (YOLO's built-in filter)
max_objects_per_frame = 3      # Maximum detections per frame (YOLO's max_det parameter)
device = cuda
classes = []                   # YOLO class IDs to include (empty = all classes, e.g., [0, 2, 5])

[object_tracking]
# Two-stage filtering process:
# 1. YOLO's built-in filtering: confidence_threshold, iou_threshold, max_objects_per_frame, classes
# 2. Our custom strategy: further selection from YOLO's filtered results

# Custom selection strategy (applied after YOLO's filtering)
selection_strategy = confidence  # Options: confidence, size, center, area
min_object_area = 500           # Minimum object area in pixels (additional filter)

# Note: Classes are filtered by YOLO using class IDs in the 'classes' parameter above
# Common YOLO class IDs: 0=person, 1=bicycle, 2=car, 3=motorcycle, 5=bus, 7=truck
# Leave 'classes' empty to detect all object types

[inpainting]
# Background inpainting configuration
method = telea
radius = 3                    # Inpainting radius
dilate_mask = true           # Whether to dilate object masks before inpainting
dilate_kernel_size = 3       # Kernel size for mask dilation

[object_output]
# Object and background output settings
save_individual_objects = true
save_combined_mask = true
save_inpainted_background = true
object_image_format = png
background_image_format = png
